# 开发帮助 #

## api 查找 ##

https://docs.microsoft.com/en-us/dotnet/api/envdte?view=visualstudiosdk-2017
在使用非DTE得时候可以在上级目录查找

## 需要保存一些对象的引用 ##
如 _dte.Events.DebuggerEvents，dte.Events.BuildEvents 等

如果本地不保存这些对象的强引用，那么在CLR(公共语言运行库）在执行到对应的监听代码的时候会生成新的对象，而不是使用之前制定的对象。

具体问题参考
https://stackoverflow.com/questions/3874015/subscription-to-dte-events-doesnt-seem-to-work-events-dont-get-called


## 监听键盘事件 ##

在DTE中我们没办法得到键盘相关的对象，我们只能通过OL1eCommand相关的事件来处理键盘事件

目前有两种方式获得键盘事件

#### Microsoft.VisualStudio.Text.Editor的KeyProcessor ，直接监听代码窗口的  keydown事件，keyup事件，inputchar事件（获取实际输入）


这是比较直观的方式,通过mef的方式扩展vs的编辑器
注意点：
- enter和backspace事件会被吞掉
- 一次长时间按压会触发多次keydown和inputchar，和一次keyup



#### 采用VsTextViewListener的方案，通过分析OL1eCommand，来解析输入

可以通过分析编辑命令相关的操作实现解析键盘输入行为

注意点
- 这部分的命令是vs消化过的，不能保证与键盘事件一一对应，所以需要慎重使用


---
事件触发顺序
> 
> PreviewKeyDown
> 
> KeyDown
> 
>TextInput
>
>(上面3个可能不存在 enter 和 backspace按键的时候)
>
> commondExecute
> 
> (持续按键的时候的会触发多次）
> 
> PreviewKeyUp
>
>KeyUp

